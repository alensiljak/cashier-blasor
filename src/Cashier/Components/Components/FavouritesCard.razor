@*
    Favourites card
*@

@inject IJSRuntime JSRuntime
@inject ISnackbar Snackbar

@using BlazorDexie.JsModule
@using Cashier.DAL
@using Cashier.Services
@using MudBlazor

<MudCard>
    <MudCardHeader Style="@($"background: {Cashier.Lib.Palette.Primary};")" Class="pa-2">
        <CardHeaderAvatar>
            <MudIcon Icon="@IconsMud.Star" Size="Size.Medium" />
        </CardHeaderAvatar>
        <CardHeaderContent>
            <MudText>Favourites</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>
        @if (accounts == null || accounts.Length == 0)
        {
            <MudText>There are no favourite accounts defined</MudText>
        }
        else
        {
            <MudList>
                @foreach (var account in accounts)
                {
                <MudListItem Text="Account: " />
                    <MudListItem Text="@account?.Name" />
                        
                }
            </MudList>
        }
    </MudCardContent>
</MudCard>

@code {
    Account?[]? accounts;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        // load data
        await loadData();
    }

    async Task loadData()
    {
        var svc = new SettingsService(JSRuntime);

        var defaultCurrency = await svc.GetDefaultCurrency();
        Console.WriteLine("default currency: {0}", defaultCurrency);

        accounts = await svc.GetFavouriteAccounts();
        
        StateHasChanged();
    }
}
