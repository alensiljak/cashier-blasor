@*
    Favourites card
*@

@inject IJSRuntime JSRuntime
@using BlazorDexie.JsModule
@using Cashier.DAL
@using Cashier.Services
@using MudBlazor

<MudCard>
    <MudCardHeader Style="@($"background: {Cashier.Lib.Palette.Primary};")" Class="pa-2">
        <CardHeaderAvatar>
            <MudIcon Icon="@IconsMud.Star" Size="Size.Medium" />
        </CardHeaderAvatar>
        <CardHeaderContent>
            <MudText>Favourites</MudText>
        </CardHeaderContent>
        <CardHeaderActions>
            @* <MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Default" /> *@
            @* <MudIcon Icon="@IconsMud.Settings" /> *@
        </CardHeaderActions>
    </MudCardHeader>
    <MudCardContent>
        Content
        <MudText>Mudtext content</MudText>
    </MudCardContent>
    <MudCardActions Class="justify-center">
        <MudButton StartIcon="@IconsMud.FileUp" Variant="Variant.Outlined" Color="Color.Tertiary">Export</MudButton>
    </MudCardActions>
</MudCard>

@code {
    private DexieDAL _db;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        // init db
        var moduleFactory = new EsModuleFactory(JSRuntime);
        _db = new DexieDAL(moduleFactory);

        // load data
        await loadData();
    }

    async Task loadData()
    {
        Console.WriteLine("db is ", _db);

        var cur = await _db.Settings.Get(SettingsKeys.currency);
        Console.WriteLine("currency is ", cur);

        // var svc = new SettingsService(Dexie);

        // var defaultCurrency = await svc.GetDefaultCurrency();
        // Console.WriteLine("default currency:", defaultCurrency);

        // var second = await svc.Get(SettingsKeys.currency);
        // Console.WriteLine("second:", second);

    }
}
