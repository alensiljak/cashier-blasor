@using MudBlazor

<MudTextField T="string" @bind-Value="Posting!.Account" Placeholder="Account" ReadOnly="true" @onclick="OnAccountClicked" />

<MudGrid>
    <MudItem xs="2">
        <MudIconButton Icon="@IconsMud.Star" />
    </MudItem>
    <MudItem xs="6">
        <MudTextField T="decimal?" @ref="amountField" @bind-Value="Amount" InputType="InputType.Number"
                      Placeholder="Amount" Class="text-right"
                      @onfocus="async () => await amountField!.SelectAsync()" />
    </MudItem>
    <MudItem lg="4" xs="4" Class="pl-0">
        <MudTextField T="string" @bind-Value="Currency" Placeholder="Currency" />
    </MudItem>
</MudGrid>

@code {
    [Parameter]
    public Posting Posting { get; set; } = default!;

    /// <summary>
    /// Event when the Account is tapped
    /// </summary>
    [Parameter]
    public EventCallback OnAccountClick { get; set; }

    decimal? Amount
    {
        get
        {
            return Posting.Amount?.Quantity;
        }
        set
        {
            if (Posting.Amount == null)
            {
                Posting.Amount = new Money();
            }

            Posting.Amount.Quantity = value;
        }
    }

    string? Currency
    {
        get
        {
            return Posting.Amount?.Currency;
        }
        set
        {
            if (Posting.Amount == null)
            {
                Posting.Amount = new Money();
            }

            Posting.Amount.Currency = value;
        }
    }

    MudTextField<decimal?> amountField { get; set; } = default!;

    private async Task OnAccountClicked()
    {
        await OnAccountClick.InvokeAsync();
    }
}
